\documentclass[12pt]{article}
\usepackage[T5]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[vietnamese,english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{listings}
\usepackage{hyperref}
\usepackage[figurename=Hình]{caption}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{enumerate}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=cyan,
    citecolor=black,
}

\author{Đỗ Quốc Thế}
\title{Chứng minh CRT cho RSA}
\begin{document}
\maketitle
\section{Chứng minh CRT cho RSA}
\textbf{CRT}: Cho $n_i \in \mathcal{P},\ n_i \neq n_j, \forall i \neq j$, $a_i \in \mathbb{N}$. Hệ phương trình (\ref{sequations:abs-crt}) có nghiệm duy nhất trong $\mathbb{Z}_{n_1n_2\hdots n_k}$

\begin{equation}\label{sequations:abs-crt}
\begin{cases}
x &\equiv a_1\ (mod\ n_1) \\
x &\equiv a_2\ (mod\ n_2) \\
& \vdots \\
x &\equiv a_k\ (mod\ n_k)
\end{cases}
\end{equation}


\textbf{RSA}: Cho $p,q \in \mathcal{P},\ p \neq q,\ n\ =\ pq,\ \phi=(p-1)(q-1),\ \phi(p)=p-1,\ \phi(q)=q-1$. Chọn $e$ sao cho $gcd(e,\phi)=1$, chọn $d$ sao cho $ed\equiv\ 1\ (mod\ \phi)$.

\textbf{Encrypt}: $c=m^e\ mod\ n$

\textbf{Decrypt}: $m=c^d\ mod\ n$

Ta có: $m\ mod\ p=(c^d\ mod\ n)\ mod\ p =c^d\ mod\ p = c^{d\ mod\ \phi(p)}\ mod\ p$

Giải thích: $d = k\phi(p) + d\ mod\ \phi(p)$

\begin{equation*}
\begin{array}{l@{}l}
c^d\ mod\ p &{}=c^{k\phi(p) + d\ mod\ \phi(p)}\ mod\ p\\
    &{}= (c^{\phi(p)})^kc^{d\ mod\ \phi(p)}\ mod\ p \\
    &{}= 1^kc^{d\ mod\ \phi(p)}\ mod\ p\ \ \ \ \ \textit{(theo định lí Fermat nhỏ)}\\
    &{}= c^{d\ mod\ \phi(p)}\ mod\ p
\end{array}
\end{equation*}

Vậy ta có: 
\begin{equation}\label{sequations:rsa-crt}
\begin{cases}
m \equiv c^{d\ mod\ \phi(p)} (mod\ p) \\
m \equiv c^{d\ mod\ \phi(q)} (mod\ q)
\end{cases}
\end{equation}

Giải hệ CRT (2) ta được $m$
\section{Chứng minh RSA đúng}
\subsection{Các bước thực hiện RSA}

\begin{enumerate}[ {(}1{)} ]
        \item Chọn 2 số nguyên tố lớn $p,q$
        \item Tính $n=pq,\ \phi= (p-1)(q-1)$
        \item Chọn $e\in[2, \phi - 1]$ sao cho $gcd(e, \phi) = 1$
        \item Tìm $d \in [2, \phi - 1]$ sao cho $ed \equiv 1\ (mod\ \phi)$

        $d$ là số duy nhất cần tìm và $gcd(d,\phi)=1$
        \item Công bố $(e, n)$ là public key
        \item Giữ $(d, n)$ là private key
\end{enumerate}

\subsection{Chứng minh RSA}
\subsubsection{d duy nhất}
Ta có $ed \equiv 1\ (mod\ \phi)$

Giả sử $\exists d' \neq d \in \mathbb{Z}_{\phi}$ sao cho $ed' \equiv 1\ (mod\ \phi)$

Ta có: 
$ed = k\phi + 1$, $ed'=k'\phi+1$

$\Rightarrow\ ed -ed' = (k-k')\phi$

$\Rightarrow\ \phi\ |\ ed - ed'$

$\Rightarrow\ \phi\ |\ e(d - d')$

mà $gcd(e,\phi) = 1$ $\Rightarrow \phi\ |\ d - d'$

$\Rightarrow d \equiv d'\ (mod\ \phi)$

\subsubsection{Giải mã đúng }
Ta cần chứng minh: $m=(m^e)^d\ mod\ n$\\
Trước hết, ta có:
Với $p,q \in \mathcal{P}$
\begin{equation*}
\begin{cases}
x &{} \equiv y\ (mod\ p)\\
x &{} \equiv y\ (mod\ q)
\end{cases}
\end{equation*}
Thì $x \equiv y\ (mod\ pq)$

\underline{\textit{Chứng minh}}:

\[
\left\{
\begin{aligned}
  x - y &=kp \\
  x-y&=k'q
\end{aligned}
\right.
\qquad\Rightarrow\qquad
\left\{
\begin{aligned}
  p\ |\ x - y\\
  q\ |\ x - y\\
\end{aligned}
\right.
\]

mà $gcd(p,q) = 1$ $\Rightarrow \ pq\ |\ x-y$

$\Rightarrow x \equiv y\ (mod\ pq)$

Ta có:

\begin{equation}\label{sequations:rsa-proof}
\begin{array}{l@{}l}
(m^e)^d\ mod\ n\ &= m^{ed}\ mod\ n\\
&= m^{k\phi + 1}\ mod\ n\\
    &=  m.m^{k(p-1)(q-1)}\ mod\ n
\end{array}
\end{equation}

Xét $x = m^{k(p-1)(q-1)}$ ta có:

\begin{equation*}
\begin{array}{l@{}l}
x\ mod\ p &{}=m^{k(p-1)(q-1)}\ mod\ p\\
    &{}= (m^{p-1})^{k(q-1)}\ mod\ p \\
    &{}= 1^{k(q-1)}\ mod\ p\ \ \ \ \ \textit{(theo định lí Fermat nhỏ)}\\
    &{}= 1
\end{array}
\end{equation*}

$\Rightarrow x \equiv 1\ (mod\ p)$

\begin{equation*}
\begin{array}{l@{}l}
x\ mod\ q &{}=m^{k(p-1)(q-1)}\ mod\ q\\
    &{}= (m^{q-1})^{k(p-1)}\ mod\ q \\
    &{}= 1^{k(p-1)}\ mod\ q\ \ \ \ \ \textit{(theo định lí Fermat nhỏ)}\\
    &{}= 1
\end{array}
\end{equation*}

$\Rightarrow x \equiv 1\ (mod\ q)$

Vậy ta có: 

\[
\left\{
\begin{aligned}
  x &\equiv 1\ mod\ p\\
  x &\equiv 1\ mod\ q
\end{aligned}
\right.
\qquad\Rightarrow\qquad
x \equiv 1\ mod\ pq
\qquad\Rightarrow\qquad
x \equiv 1\ mod\ n 
\]

(\ref{sequations:rsa-proof}) $\Rightarrow (m^e)^d\ mod\ n\ = m.m^{k(p-1)(q-1)}\ mod\ n = m\ mod\ n$ 

\end{document}